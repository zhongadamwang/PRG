<Project>
  <PropertyGroup>
    <!-- å…¨å±€å¼ºåˆ¶ç¦ç”¨ @code å— -->
    <DisableCodeBlocks>true</DisableCodeBlocks>
  </PropertyGroup>
  
  <!-- åœ¨æ‰€æœ‰ Blazor é¡¹ç›®ä¸­æ£€æµ‹ @code å— -->
  <Target Name="GlobalCheckForCodeBlocks" BeforeTargets="Build" Condition="'$(DisableCodeBlocks)' == 'true'">
    <ItemGroup>
      <AllRazorFiles Include="**/*.razor" />
      <RazorFilesWithCodeBlocks Include="@(AllRazorFiles)" Condition="$([System.IO.File]::Exists('%(FullPath)')) And $([System.IO.File]::ReadAllText('%(FullPath)').Contains('@code'))" />
    </ItemGroup>
    
    <Error Text="âŒ @code blocks are not allowed in this project! Please use code-behind files (.razor.cs) instead.%0AğŸ“ Found @code block in: %(RazorFilesWithCodeBlocks.Identity)%0AğŸ’¡ To fix: Move the code from @code block to a .razor.cs file." 
           Condition="@(RazorFilesWithCodeBlocks->Count()) > 0" />
  </Target>
</Project>